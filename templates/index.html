{{ block "index" . }}
<!DOCTYPE html>
<html lang="en">
    <head>
        <title></title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script src="https://cdn.jsdelivr.net/npm/@unocss/runtime/uno.global.js"></script>
        <script src="https://unpkg.com/htmx.org@1.9.10" integrity="sha384-D1Kt99CQMDuVetoL1lrYwg5t+9QdHe7NLX/SoJYkXDFfX37iInKRy5xLSi8nO7UC" crossorigin="anonymous"></script>
    </head>
    <body class="m-0 p-0 font-sans text-base bg-slate-800 text-slate-200">
        <header class="flex justify-center items-center h-20 shadow shadow-slate-900 bg-slate-700">
            <input type="search" name="search" placeholder="Beware of Chiken"
                class="w-10/12 md:w-64 h-8"
                hx-get="/search/"
                hx-trigger="keyup delay:200mx changed"
                hx-target="#shelfList">
        </header>

        <section class="flex flex-col md:flex-row gap-2 justify-center mt-4 mx-2">
            <main class="flex flex-col gap-2 w-11/12 md:w-2/3 p-2">
                <form>
                    <label for="bookUrl">Url</label>
                    <input type="url" id="bookUrl" name="bookUrl" placeholder="https://archiveiofou...">
                    <label for="bookName">Name</label>
                    <input type="text" id="bookName" name="bookName" placeholder="Folklore Worm...">
                    <label for="bookChapter">Last Viewed Chapter</label>
                    <input type="number" id="bookChapter" name="bookChapter" placeholder="4">
                </form>
                <button type="submit"
                    hx-include="previous form"
                    hx-post="/book/"
                    hx-target="body">
                    Add New
                </button> 
                <h1>Shelf</h1>

                <section class="flex flex-col gap-2" id="shelfList">
                    {{ template "bookList" . }}
                </section>
            </main>

            <aside class="w-11/12 md:w-72 h-72 p-2 shadow shadow-slate-900 bg-slate-600">
                <h1>Recent Updates</h1>
                <p>I put in too much work for this thing so even though it's not going to be used I'll keep it</p>
            </aside>
        </section>
    </body>
</html>
{{ end }}


{{ block "bookList" . }}
{{ range .Results }}
{{ block "book" . }}
<div id="book" class="p-2 shadow shadow shadow-slate-900 bg-slate-700">
    <a class="text-gray-200 text-lg"
        href="{{ .Url }}">
        {{ .Name }}
    </a>

    <div class="float-right">
        <p>Last Viewed Chapter: {{ .CurrentChapter }}</p>
        <button hx-get="/book/{{ .Id }}/edit"
            hx-target="closest #book">
            Edit
        </button>
        <button hx-delete="/book/{{ .Id }}/"
            hx-target="body"
            hx-confirm="Are you sure you want to delete this book">
            Delete
        </button>
    </div>
</div>
{{ end }}
{{ end }}
{{ end }}


{{ block "bookEdit" . }}
<form>
    <label for="bookUrl">Url</label>
    <input type="url" id="bookUrl" name="bookUrl" value="{{ .Name }}">
    <label for="bookName">Name</label>
    <input type="text" id="bookName" name="bookName" value="{{ .Url }}">
    <label for="bookChapter">Last Viewed Chapter</label>
    <input type="number" id="bookChapter" name="bookChapter" value="{{ .CurrentChapter }}">
</form>
<button type="submit"
    hx-include="previous form"
    hx-post="/book/"
    hx-target="body">
    Add New
</button> 
{{ end }}
